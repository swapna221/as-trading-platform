server:
  port: 8089

spring:
  application:
    name: manual-order-svc

  kafka:
    bootstrap-servers: localhost:9092
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer

  # ======================================================================
  # DATABASE + JPA (MySQL)
  # ======================================================================
  datasource:
    url: jdbc:mysql://localhost:3306/trading_platform?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
    username: root
    password: password
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    open-in-view: false
    hibernate:
      ddl-auto: update         # do not auto-change schema; only validate
    database-platform: org.hibernate.dialect.MySQLDialect
    properties:
      hibernate:
        format_sql: true

  flyway:
    enabled: true
    locations: classpath:db/migration    # V1__init.sql etc.


# ======================================================================
# AUTH SERVICE + JWT
# ======================================================================
auth-service:
  url: http://localhost:8090

jwt:
  secret: aVeryLongAndSecureSecretKeyThatHas32CharsOrMore!

  redis:
    host: localhost
    port: 6379


# ======================================================================
# EUREKA
# ======================================================================
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka


# ======================================================================
# KAFKA TOPICS
# ======================================================================
kafka:
  topic:
    manual-order: manual-order-topic
    manual-trade: manual-trade-topic


# ======================================================================
# REDIS (unchanged)
# ======================================================================
redis:
  host: localhost
  port: 6379
  key:
    prefix:
      dhan-user: dhan:user


# ======================================================================
# DHAN API CONFIG
# ======================================================================
dhan:
  base-url: https://api.dhan.co
  default-user-id: 1


# ======================================================================
# INSTRUMENT MASTER LOADER CONFIG
# ======================================================================
instrument:
  csv-url: https://images.dhan.co/api-data/api-scrip-master.csv
  reload-cron: "0 5 8 * * MON-FRI"   # refresh each trading day at 8:05 AM

logging:
  level:
    com.trading.manualorderservice.service.TrailingSlEngine: DEBUG
